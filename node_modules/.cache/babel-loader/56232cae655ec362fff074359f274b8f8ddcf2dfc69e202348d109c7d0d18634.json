{"ast":null,"code":"// src/exercises/ChairSquats.js\n\nlet prevState = 'standing'; // or 'squatting'\nlet lastSpoken = '';\nlet lastSpeakTime = 0;\nexport function resetChairSquat() {\n  prevState = 'standing';\n  lastSpoken = '';\n  lastSpeakTime = 0;\n}\nexport function processChairSquat(landmarks) {\n  const now = Date.now();\n\n  // MediaPipe landmarks: 0-33, normalized [0-1]\n  const leftHip = landmarks[23];\n  const leftKnee = landmarks[25];\n  const leftAnkle = landmarks[27];\n  const rightHip = landmarks[24];\n  const rightKnee = landmarks[26];\n  const rightAnkle = landmarks[28];\n  if (!leftHip || !leftKnee || !leftAnkle || !rightHip || !rightKnee || !rightAnkle) {\n    return {\n      speak: 'Unable to detect keypoints clearly'\n    };\n  }\n  const getAngle = (a, b, c) => {\n    const ab = {\n      x: a.x - b.x,\n      y: a.y - b.y\n    };\n    const cb = {\n      x: c.x - b.x,\n      y: c.y - b.y\n    };\n    const dot = ab.x * cb.x + ab.y * cb.y;\n    const magAB = Math.sqrt(ab.x * ab.x + ab.y * ab.y);\n    const magCB = Math.sqrt(cb.x * cb.x + cb.y * cb.y);\n    const angle = Math.acos(dot / (magAB * magCB));\n    return angle * 180 / Math.PI;\n  };\n  const leftKneeAngle = getAngle(leftHip, leftKnee, leftAnkle);\n  const rightKneeAngle = getAngle(rightHip, rightKnee, rightAnkle);\n  const avgKneeAngle = (leftKneeAngle + rightKneeAngle) / 2;\n\n  // Squat logic\n  if (avgKneeAngle < 100 && prevState === 'standing') {\n    prevState = 'squatting';\n    return {\n      speak: 'Good squat'\n    };\n  }\n  if (avgKneeAngle > 160 && prevState === 'squatting') {\n    prevState = 'standing';\n    return {\n      rep: 1,\n      speak: 'Squat complete'\n    };\n  }\n\n  // Continuous feedback (but throttled)\n  if (avgKneeAngle > 130 && now - lastSpeakTime > 3000) {\n    lastSpeakTime = now;\n    if (lastSpoken !== 'Try to bend your knees more') {\n      lastSpoken = 'Try to bend your knees more';\n      return {\n        speak: lastSpoken\n      };\n    }\n  }\n  return null;\n}","map":{"version":3,"names":["prevState","lastSpoken","lastSpeakTime","resetChairSquat","processChairSquat","landmarks","now","Date","leftHip","leftKnee","leftAnkle","rightHip","rightKnee","rightAnkle","speak","getAngle","a","b","c","ab","x","y","cb","dot","magAB","Math","sqrt","magCB","angle","acos","PI","leftKneeAngle","rightKneeAngle","avgKneeAngle","rep"],"sources":["/Users/jesvinblazegmail.com/PycharmProjects/Ai-rehab/src/exercises/ChairSquats.js"],"sourcesContent":["// src/exercises/ChairSquats.js\n\nlet prevState = 'standing'; // or 'squatting'\nlet lastSpoken = '';\nlet lastSpeakTime = 0;\n\nexport function resetChairSquat() {\n  prevState = 'standing';\n  lastSpoken = '';\n  lastSpeakTime = 0;\n}\n\nexport function processChairSquat(landmarks) {\n  const now = Date.now();\n\n  // MediaPipe landmarks: 0-33, normalized [0-1]\n  const leftHip = landmarks[23];\n  const leftKnee = landmarks[25];\n  const leftAnkle = landmarks[27];\n\n  const rightHip = landmarks[24];\n  const rightKnee = landmarks[26];\n  const rightAnkle = landmarks[28];\n\n  if (!leftHip || !leftKnee || !leftAnkle || !rightHip || !rightKnee || !rightAnkle) {\n    return { speak: 'Unable to detect keypoints clearly' };\n  }\n\n  const getAngle = (a, b, c) => {\n    const ab = { x: a.x - b.x, y: a.y - b.y };\n    const cb = { x: c.x - b.x, y: c.y - b.y };\n\n    const dot = ab.x * cb.x + ab.y * cb.y;\n    const magAB = Math.sqrt(ab.x * ab.x + ab.y * ab.y);\n    const magCB = Math.sqrt(cb.x * cb.x + cb.y * cb.y);\n\n    const angle = Math.acos(dot / (magAB * magCB));\n    return (angle * 180) / Math.PI;\n  };\n\n  const leftKneeAngle = getAngle(leftHip, leftKnee, leftAnkle);\n  const rightKneeAngle = getAngle(rightHip, rightKnee, rightAnkle);\n  const avgKneeAngle = (leftKneeAngle + rightKneeAngle) / 2;\n\n  // Squat logic\n  if (avgKneeAngle < 100 && prevState === 'standing') {\n    prevState = 'squatting';\n    return { speak: 'Good squat' };\n  }\n\n  if (avgKneeAngle > 160 && prevState === 'squatting') {\n    prevState = 'standing';\n    return { rep: 1, speak: 'Squat complete' };\n  }\n\n  // Continuous feedback (but throttled)\n  if (avgKneeAngle > 130 && now - lastSpeakTime > 3000) {\n    lastSpeakTime = now;\n    if (lastSpoken !== 'Try to bend your knees more') {\n      lastSpoken = 'Try to bend your knees more';\n      return { speak: lastSpoken };\n    }\n  }\n\n  return null;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}